import{X as m,E as x,_ as b,O as qn}from"./graph-p79cratq-BQ6Vu1hs.js";import{H as Yn,Z as f,y as q,n as gn,a as j,C as ln,G as Vn,Y as F,T as An,q as R,F as pn,j as wn,x as H,R as zn,M as Dn,b as Hn,c as Jn}from"./_baseUniq-Ct25NOJ9-BqPXUSUN.js";import{L as O,v as Un,k as I,M as p,A as bn,x as Zn}from"./min-Bdw3L8_w-DNqxvqy3.js";import{ao as mn,ap as L,aq as yn,ar as Qn,as as J,at as Wn,au as Kn,av as kn,aw as xn,ax as Xn,ay as nr,az as rr,aA as C,aB as tr,aC as En,aD as er,aE as or}from"./index-EvFfW_6K.js";var ir=/\s/;function ar(n){for(var r=n.length;r--&&ir.test(n.charAt(r)););return r}var ur=/^\s+/;function cr(n){return n&&n.slice(0,ar(n)+1).replace(ur,"")}var tn=NaN,dr=/^[-+]0x[0-9a-f]+$/i,fr=/^0b[01]+$/i,sr=/^0o[0-7]+$/i,hr=parseInt;function vr(n){if(typeof n=="number")return n;if(H(n))return tn;if(C(n)){var r=typeof n.valueOf=="function"?n.valueOf():n;n=C(r)?r+"":r}if(typeof n!="string")return n===0?n:+n;n=cr(n);var t=fr.test(n);return t||sr.test(n)?hr(n.slice(2),t?2:8):dr.test(n)?tn:+n}var gr=1/0,lr=17976931348623157e292;function T(n){if(!n)return n===0?n:0;if(n=vr(n),n===gr||n===-1/0){var r=n<0?-1:1;return r*lr}return n===n?n:0}function pr(n){var r=T(n),t=r%1;return r===r?t?r-t:r:0}function wr(n){return Wn(Kn(n,void 0,O),n+"")}var br=1,mr=4;function yr(n){return qn(n,br|mr)}var On=Object.prototype,kr=On.hasOwnProperty,xr=mn(function(n,r){n=Object(n);var t=-1,e=r.length,o=e>2?r[2]:void 0;for(o&&L(r[0],r[1],o)&&(e=1);++t<e;)for(var a=r[t],i=yn(a),u=-1,c=i.length;++u<c;){var d=i[u],s=n[d];(s===void 0||Qn(s,On[d])&&!kr.call(n,d))&&(n[d]=a[d])}return n});function $(n){var r=n==null?0:n.length;return r?n[r-1]:void 0}function Er(n){return function(r,t,e){var o=Object(r);if(!er(r)){var a=j(t);r=Dn(r),t=function(u){return a(o[u],u,o)}}var i=n(r,t,e);return i>-1?o[a?r[i]:i]:void 0}}var Or=Math.max;function Nr(n,r,t){var e=n==null?0:n.length;if(!e)return-1;var o=t==null?0:pr(t);return o<0&&(o=Or(e+o,0)),Jn(n,j(r),o)}var Z=Er(Nr);function _r(n,r){return n==null?n:or(n,pn(r),yn)}function Ir(n,r){return n&&ln(n,pn(r))}function Pr(n,r){return n>r}var jr=Object.prototype,Rr=jr.hasOwnProperty;function Mr(n,r){return n!=null&&Rr.call(n,r)}function Nn(n,r){return n!=null&&An(n,r,Mr)}function G(n,r){var t={};return r=j(r),ln(n,function(e,o,a){nr(t,o,r(e,o,a))}),t}function y(n){return n&&n.length?bn(n,xn,Pr):void 0}function Q(n,r){return n&&n.length?bn(n,j(r),Zn):void 0}function Tr(n,r,t,e){if(!C(n))return n;r=wn(r,n);for(var o=-1,a=r.length,i=a-1,u=n;u!=null&&++o<a;){var c=zn(r[o]),d=t;if(c==="__proto__"||c==="constructor"||c==="prototype")return n;if(o!=i){var s=u[c];d=void 0,d===void 0&&(d=C(s)?s:tr(r[o+1])?[]:{})}En(u,c,d),u=u[c]}return n}function Lr(n,r,t){for(var e=-1,o=r.length,a={};++e<o;){var i=r[e],u=gn(n,i);t(u,i)&&Tr(a,wn(i,n),u)}return a}function Cr(n,r){var t=n.length;for(n.sort(r);t--;)n[t]=n[t].value;return n}function $r(n,r){if(n!==r){var t=n!==void 0,e=n===null,o=n===n,a=H(n),i=r!==void 0,u=r===null,c=r===r,d=H(r);if(!u&&!d&&!a&&n>r||a&&i&&c&&!u&&!d||e&&i&&c||!t&&c||!o)return 1;if(!e&&!a&&!d&&n<r||d&&t&&o&&!e&&!a||u&&t&&o||!i&&o||!c)return-1}return 0}function Sr(n,r,t){for(var e=-1,o=n.criteria,a=r.criteria,i=o.length,u=t.length;++e<i;){var c=$r(o[e],a[e]);if(c){if(e>=u)return c;var d=t[e];return c*(d=="desc"?-1:1)}}return n.index-r.index}function Fr(n,r,t){r.length?r=q(r,function(a){return kn(a)?function(i){return gn(i,a.length===1?a[0]:a)}:a}):r=[xn];var e=-1;r=q(r,Xn(j));var o=Un(n,function(a,i,u){var c=q(r,function(d){return d(a)});return{criteria:c,index:++e,value:a}});return Cr(o,function(a,i){return Sr(a,i,t)})}function Gr(n,r){return Lr(n,r,function(t,e){return Hn(n,e)})}var S=wr(function(n,r){return n==null?{}:Gr(n,r)}),Br=Math.ceil,qr=Math.max;function Yr(n,r,t,e){for(var o=-1,a=qr(Br((r-n)/(t||1)),0),i=Array(a);a--;)i[++o]=n,n+=t;return i}function Vr(n){return function(r,t,e){return e&&typeof e!="number"&&L(r,t,e)&&(t=e=void 0),r=T(r),t===void 0?(t=r,r=0):t=T(t),e=e===void 0?r<t?1:-1:T(e),Yr(r,t,e)}}var E=Vr(),M=mn(function(n,r){if(n==null)return[];var t=r.length;return t>1&&L(n,r[0],r[1])?r=[]:t>2&&L(r[0],r[1],r[2])&&(r=[r[0]]),Fr(n,Yn(r),[])}),Ar=0;function W(n){var r=++Ar;return Vn(n)+r}function zr(n,r,t){for(var e=-1,o=n.length,a=r.length,i={};++e<o;){var u=e<a?r[e]:void 0;t(i,n[e],u)}return i}function Dr(n,r){return zr(n||[],r||[],En)}class Hr{constructor(){var r={};r._next=r._prev=r,this._sentinel=r}dequeue(){var r=this._sentinel,t=r._prev;if(t!==r)return en(t),t}enqueue(r){var t=this._sentinel;r._prev&&r._next&&en(r),r._next=t._next,t._next._prev=r,t._next=r,r._prev=t}toString(){for(var r=[],t=this._sentinel,e=t._prev;e!==t;)r.push(JSON.stringify(e,Jr)),e=e._prev;return"["+r.join(", ")+"]"}}function en(n){n._prev._next=n._next,n._next._prev=n._prev,delete n._next,delete n._prev}function Jr(n,r){if(n!=="_next"&&n!=="_prev")return r}var Ur=rr(1);function Zr(n,r){if(n.nodeCount()<=1)return[];var t=Wr(n,r||Ur),e=Qr(t.graph,t.buckets,t.zeroIdx);return O(p(e,function(o){return n.outEdges(o.v,o.w)}))}function Qr(n,r,t){for(var e=[],o=r[r.length-1],a=r[0],i;n.nodeCount();){for(;i=a.dequeue();)Y(n,r,t,i);for(;i=o.dequeue();)Y(n,r,t,i);if(n.nodeCount()){for(var u=r.length-2;u>0;--u)if(i=r[u].dequeue(),i){e=e.concat(Y(n,r,t,i,!0));break}}}return e}function Y(n,r,t,e,o){var a=o?[]:void 0;return f(n.inEdges(e.v),function(i){var u=n.edge(i),c=n.node(i.v);o&&a.push({v:i.v,w:i.w}),c.out-=u,U(r,t,c)}),f(n.outEdges(e.v),function(i){var u=n.edge(i),c=i.w,d=n.node(c);d.in-=u,U(r,t,d)}),n.removeNode(e.v),a}function Wr(n,r){var t=new m,e=0,o=0;f(n.nodes(),function(u){t.setNode(u,{v:u,in:0,out:0})}),f(n.edges(),function(u){var c=t.edge(u.v,u.w)||0,d=r(u),s=c+d;t.setEdge(u.v,u.w,s),o=Math.max(o,t.node(u.v).out+=d),e=Math.max(e,t.node(u.w).in+=d)});var a=E(o+e+3).map(function(){return new Hr}),i=e+1;return f(t.nodes(),function(u){U(a,i,t.node(u))}),{graph:t,buckets:a,zeroIdx:i}}function U(n,r,t){t.out?t.in?n[t.out-t.in+r].enqueue(t):n[n.length-1].enqueue(t):n[0].enqueue(t)}function Kr(n){var r=n.graph().acyclicer==="greedy"?Zr(n,t(n)):Xr(n);f(r,function(e){var o=n.edge(e);n.removeEdge(e),o.forwardName=e.name,o.reversed=!0,n.setEdge(e.w,e.v,o,W("rev"))});function t(e){return function(o){return e.edge(o).weight}}}function Xr(n){var r=[],t={},e={};function o(a){Object.prototype.hasOwnProperty.call(e,a)||(e[a]=!0,t[a]=!0,f(n.outEdges(a),function(i){Object.prototype.hasOwnProperty.call(t,i.w)?r.push(i):o(i.w)}),delete t[a])}return f(n.nodes(),o),r}function nt(n){f(n.edges(),function(r){var t=n.edge(r);if(t.reversed){n.removeEdge(r);var e=t.forwardName;delete t.reversed,delete t.forwardName,n.setEdge(r.w,r.v,t,e)}})}function N(n,r,t,e){var o;do o=W(e);while(n.hasNode(o));return t.dummy=r,n.setNode(o,t),o}function rt(n){var r=new m().setGraph(n.graph());return f(n.nodes(),function(t){r.setNode(t,n.node(t))}),f(n.edges(),function(t){var e=r.edge(t.v,t.w)||{weight:0,minlen:1},o=n.edge(t);r.setEdge(t.v,t.w,{weight:e.weight+o.weight,minlen:Math.max(e.minlen,o.minlen)})}),r}function _n(n){var r=new m({multigraph:n.isMultigraph()}).setGraph(n.graph());return f(n.nodes(),function(t){n.children(t).length||r.setNode(t,n.node(t))}),f(n.edges(),function(t){r.setEdge(t,n.edge(t))}),r}function on(n,r){var t=n.x,e=n.y,o=r.x-t,a=r.y-e,i=n.width/2,u=n.height/2;if(!o&&!a)throw new Error("Not possible to find intersection inside of the rectangle");var c,d;return Math.abs(a)*i>Math.abs(o)*u?(a<0&&(u=-u),c=u*o/a,d=u):(o<0&&(i=-i),c=i,d=i*a/o),{x:t+c,y:e+d}}function B(n){var r=p(E(In(n)+1),function(){return[]});return f(n.nodes(),function(t){var e=n.node(t),o=e.rank;b(o)||(r[o][e.order]=t)}),r}function tt(n){var r=I(p(n.nodes(),function(t){return n.node(t).rank}));f(n.nodes(),function(t){var e=n.node(t);Nn(e,"rank")&&(e.rank-=r)})}function et(n){var r=I(p(n.nodes(),function(a){return n.node(a).rank})),t=[];f(n.nodes(),function(a){var i=n.node(a).rank-r;t[i]||(t[i]=[]),t[i].push(a)});var e=0,o=n.graph().nodeRankFactor;f(t,function(a,i){b(a)&&i%o!==0?--e:e&&f(a,function(u){n.node(u).rank+=e})})}function an(n,r,t,e){var o={width:0,height:0};return arguments.length>=4&&(o.rank=t,o.order=e),N(n,"border",o,r)}function In(n){return y(p(n.nodes(),function(r){var t=n.node(r).rank;if(!b(t))return t}))}function ot(n,r){var t={lhs:[],rhs:[]};return f(n,function(e){r(e)?t.lhs.push(e):t.rhs.push(e)}),t}function it(n,r){return r()}function at(n){function r(t){var e=n.children(t),o=n.node(t);if(e.length&&f(e,r),Object.prototype.hasOwnProperty.call(o,"minRank")){o.borderLeft=[],o.borderRight=[];for(var a=o.minRank,i=o.maxRank+1;a<i;++a)un(n,"borderLeft","_bl",t,o,a),un(n,"borderRight","_br",t,o,a)}}f(n.children(),r)}function un(n,r,t,e,o,a){var i={width:0,height:0,rank:a,borderType:r},u=o[r][a-1],c=N(n,"border",i,t);o[r][a]=c,n.setParent(c,e),u&&n.setEdge(u,c,{weight:1})}function ut(n){var r=n.graph().rankdir.toLowerCase();(r==="lr"||r==="rl")&&Pn(n)}function ct(n){var r=n.graph().rankdir.toLowerCase();(r==="bt"||r==="rl")&&dt(n),(r==="lr"||r==="rl")&&(ft(n),Pn(n))}function Pn(n){f(n.nodes(),function(r){cn(n.node(r))}),f(n.edges(),function(r){cn(n.edge(r))})}function cn(n){var r=n.width;n.width=n.height,n.height=r}function dt(n){f(n.nodes(),function(r){V(n.node(r))}),f(n.edges(),function(r){var t=n.edge(r);f(t.points,V),Object.prototype.hasOwnProperty.call(t,"y")&&V(t)})}function V(n){n.y=-n.y}function ft(n){f(n.nodes(),function(r){A(n.node(r))}),f(n.edges(),function(r){var t=n.edge(r);f(t.points,A),Object.prototype.hasOwnProperty.call(t,"x")&&A(t)})}function A(n){var r=n.x;n.x=n.y,n.y=r}function st(n){n.graph().dummyChains=[],f(n.edges(),function(r){ht(n,r)})}function ht(n,r){var t=r.v,e=n.node(t).rank,o=r.w,a=n.node(o).rank,i=r.name,u=n.edge(r),c=u.labelRank;if(a!==e+1){n.removeEdge(r);var d=void 0,s,h;for(h=0,++e;e<a;++h,++e)u.points=[],d={width:0,height:0,edgeLabel:u,edgeObj:r,rank:e},s=N(n,"edge",d,"_d"),e===c&&(d.width=u.width,d.height=u.height,d.dummy="edge-label",d.labelpos=u.labelpos),n.setEdge(t,s,{weight:u.weight},i),h===0&&n.graph().dummyChains.push(s),t=s;n.setEdge(t,o,{weight:u.weight},i)}}function vt(n){f(n.graph().dummyChains,function(r){var t=n.node(r),e=t.edgeLabel,o;for(n.setEdge(t.edgeObj,e);t.dummy;)o=n.successors(r)[0],n.removeNode(r),e.points.push({x:t.x,y:t.y}),t.dummy==="edge-label"&&(e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height),r=o,t=n.node(r)})}function K(n){var r={};function t(e){var o=n.node(e);if(Object.prototype.hasOwnProperty.call(r,e))return o.rank;r[e]=!0;var a=I(p(n.outEdges(e),function(i){return t(i.w)-n.edge(i).minlen}));return(a===Number.POSITIVE_INFINITY||a===void 0||a===null)&&(a=0),o.rank=a}f(n.sources(),t)}function P(n,r){return n.node(r.w).rank-n.node(r.v).rank-n.edge(r).minlen}function jn(n){var r=new m({directed:!1}),t=n.nodes()[0],e=n.nodeCount();r.setNode(t,{});for(var o,a;gt(r,n)<e;)o=lt(r,n),a=r.hasNode(o.v)?P(n,o):-P(n,o),pt(r,n,a);return r}function gt(n,r){function t(e){f(r.nodeEdges(e),function(o){var a=o.v,i=e===a?o.w:a;!n.hasNode(i)&&!P(r,o)&&(n.setNode(i,{}),n.setEdge(e,i,{}),t(i))})}return f(n.nodes(),t),n.nodeCount()}function lt(n,r){return Q(r.edges(),function(t){if(n.hasNode(t.v)!==n.hasNode(t.w))return P(r,t)})}function pt(n,r,t){f(n.nodes(),function(e){r.node(e).rank+=t})}function Rn(n,r,t){kn(r)||(r=[r]);var e=(n.isDirected()?n.successors:n.neighbors).bind(n),o=[],a={};return f(r,function(i){if(!n.hasNode(i))throw new Error("Graph does not have node: "+i);Mn(n,i,t==="post",a,e,o)}),o}function Mn(n,r,t,e,o,a){Object.prototype.hasOwnProperty.call(e,r)||(e[r]=!0,t||a.push(r),f(o(r),function(i){Mn(n,i,t,e,o,a)}),t&&a.push(r))}function wt(n,r){return Rn(n,r,"post")}function bt(n,r){return Rn(n,r,"pre")}k.initLowLimValues=nn;k.initCutValues=X;k.calcCutValue=Tn;k.leaveEdge=Cn;k.enterEdge=$n;k.exchangeEdges=Sn;function k(n){n=rt(n),K(n);var r=jn(n);nn(r),X(r,n);for(var t,e;t=Cn(r);)e=$n(r,n,t),Sn(r,n,t,e)}function X(n,r){var t=wt(n,n.nodes());t=t.slice(0,t.length-1),f(t,function(e){mt(n,r,e)})}function mt(n,r,t){var e=n.node(t),o=e.parent;n.edge(t,o).cutvalue=Tn(n,r,t)}function Tn(n,r,t){var e=n.node(t),o=e.parent,a=!0,i=r.edge(t,o),u=0;return i||(a=!1,i=r.edge(o,t)),u=i.weight,f(r.nodeEdges(t),function(c){var d=c.v===t,s=d?c.w:c.v;if(s!==o){var h=d===a,v=r.edge(c).weight;if(u+=h?v:-v,kt(n,t,s)){var g=n.edge(t,s).cutvalue;u+=h?-g:g}}}),u}function nn(n,r){arguments.length<2&&(r=n.nodes()[0]),Ln(n,{},1,r)}function Ln(n,r,t,e,o){var a=t,i=n.node(e);return r[e]=!0,f(n.neighbors(e),function(u){Object.prototype.hasOwnProperty.call(r,u)||(t=Ln(n,r,t,u,e))}),i.low=a,i.lim=t++,o?i.parent=o:delete i.parent,t}function Cn(n){return Z(n.edges(),function(r){return n.edge(r).cutvalue<0})}function $n(n,r,t){var e=t.v,o=t.w;r.hasEdge(e,o)||(e=t.w,o=t.v);var a=n.node(e),i=n.node(o),u=a,c=!1;a.lim>i.lim&&(u=i,c=!0);var d=R(r.edges(),function(s){return c===dn(n,n.node(s.v),u)&&c!==dn(n,n.node(s.w),u)});return Q(d,function(s){return P(r,s)})}function Sn(n,r,t,e){var o=t.v,a=t.w;n.removeEdge(o,a),n.setEdge(e.v,e.w,{}),nn(n),X(n,r),yt(n,r)}function yt(n,r){var t=Z(n.nodes(),function(o){return!r.node(o).parent}),e=bt(n,t);e=e.slice(1),f(e,function(o){var a=n.node(o).parent,i=r.edge(o,a),u=!1;i||(i=r.edge(a,o),u=!0),r.node(o).rank=r.node(a).rank+(u?i.minlen:-i.minlen)})}function kt(n,r,t){return n.hasEdge(r,t)}function dn(n,r,t){return t.low<=r.lim&&r.lim<=t.lim}function xt(n){switch(n.graph().ranker){case"network-simplex":fn(n);break;case"tight-tree":Ot(n);break;case"longest-path":Et(n);break;default:fn(n)}}var Et=K;function Ot(n){K(n),jn(n)}function fn(n){k(n)}function Nt(n){var r=N(n,"root",{},"_root"),t=_t(n),e=y(x(t))-1,o=2*e+1;n.graph().nestingRoot=r,f(n.edges(),function(i){n.edge(i).minlen*=o});var a=It(n)+1;f(n.children(),function(i){Fn(n,r,o,a,e,t,i)}),n.graph().nodeRankFactor=o}function Fn(n,r,t,e,o,a,i){var u=n.children(i);if(!u.length){i!==r&&n.setEdge(r,i,{weight:0,minlen:t});return}var c=an(n,"_bt"),d=an(n,"_bb"),s=n.node(i);n.setParent(c,i),s.borderTop=c,n.setParent(d,i),s.borderBottom=d,f(u,function(h){Fn(n,r,t,e,o,a,h);var v=n.node(h),g=v.borderTop?v.borderTop:h,l=v.borderBottom?v.borderBottom:h,w=v.borderTop?e:2*e,_=g!==l?1:o-a[i]+1;n.setEdge(c,g,{weight:w,minlen:_,nestingEdge:!0}),n.setEdge(l,d,{weight:w,minlen:_,nestingEdge:!0})}),n.parent(i)||n.setEdge(r,c,{weight:0,minlen:o+a[i]})}function _t(n){var r={};function t(e,o){var a=n.children(e);a&&a.length&&f(a,function(i){t(i,o+1)}),r[e]=o}return f(n.children(),function(e){t(e,1)}),r}function It(n){return F(n.edges(),function(r,t){return r+n.edge(t).weight},0)}function Pt(n){var r=n.graph();n.removeNode(r.nestingRoot),delete r.nestingRoot,f(n.edges(),function(t){var e=n.edge(t);e.nestingEdge&&n.removeEdge(t)})}function jt(n,r,t){var e={},o;f(t,function(a){for(var i=n.parent(a),u,c;i;){if(u=n.parent(i),u?(c=e[u],e[u]=i):(c=o,o=i),c&&c!==i){r.setEdge(c,i);return}i=u}})}function Rt(n,r,t){var e=Mt(n),o=new m({compound:!0}).setGraph({root:e}).setDefaultNodeLabel(function(a){return n.node(a)});return f(n.nodes(),function(a){var i=n.node(a),u=n.parent(a);(i.rank===r||i.minRank<=r&&r<=i.maxRank)&&(o.setNode(a),o.setParent(a,u||e),f(n[t](a),function(c){var d=c.v===a?c.w:c.v,s=o.edge(d,a),h=b(s)?0:s.weight;o.setEdge(d,a,{weight:n.edge(c).weight+h})}),Object.prototype.hasOwnProperty.call(i,"minRank")&&o.setNode(a,{borderLeft:i.borderLeft[r],borderRight:i.borderRight[r]}))}),o}function Mt(n){for(var r;n.hasNode(r=W("_root")););return r}function Tt(n,r){for(var t=0,e=1;e<r.length;++e)t+=Lt(n,r[e-1],r[e]);return t}function Lt(n,r,t){for(var e=Dr(t,p(t,function(d,s){return s})),o=O(p(r,function(d){return M(p(n.outEdges(d),function(s){return{pos:e[s.w],weight:n.edge(s).weight}}),"pos")})),a=1;a<t.length;)a<<=1;var i=2*a-1;a-=1;var u=p(new Array(i),function(){return 0}),c=0;return f(o.forEach(function(d){var s=d.pos+a;u[s]+=d.weight;for(var h=0;s>0;)s%2&&(h+=u[s+1]),s=s-1>>1,u[s]+=d.weight;c+=d.weight*h})),c}function Ct(n){var r={},t=R(n.nodes(),function(u){return!n.children(u).length}),e=y(p(t,function(u){return n.node(u).rank})),o=p(E(e+1),function(){return[]});function a(u){if(!Nn(r,u)){r[u]=!0;var c=n.node(u);o[c.rank].push(u),f(n.successors(u),a)}}var i=M(t,function(u){return n.node(u).rank});return f(i,a),o}function $t(n,r){return p(r,function(t){var e=n.inEdges(t);if(e.length){var o=F(e,function(a,i){var u=n.edge(i),c=n.node(i.v);return{sum:a.sum+u.weight*c.order,weight:a.weight+u.weight}},{sum:0,weight:0});return{v:t,barycenter:o.sum/o.weight,weight:o.weight}}else return{v:t}})}function St(n,r){var t={};f(n,function(o,a){var i=t[o.v]={indegree:0,in:[],out:[],vs:[o.v],i:a};b(o.barycenter)||(i.barycenter=o.barycenter,i.weight=o.weight)}),f(r.edges(),function(o){var a=t[o.v],i=t[o.w];!b(a)&&!b(i)&&(i.indegree++,a.out.push(t[o.w]))});var e=R(t,function(o){return!o.indegree});return Ft(e)}function Ft(n){var r=[];function t(a){return function(i){i.merged||(b(i.barycenter)||b(a.barycenter)||i.barycenter>=a.barycenter)&&Gt(a,i)}}function e(a){return function(i){i.in.push(a),--i.indegree===0&&n.push(i)}}for(;n.length;){var o=n.pop();r.push(o),f(o.in.reverse(),t(o)),f(o.out,e(o))}return p(R(r,function(a){return!a.merged}),function(a){return S(a,["vs","i","barycenter","weight"])})}function Gt(n,r){var t=0,e=0;n.weight&&(t+=n.barycenter*n.weight,e+=n.weight),r.weight&&(t+=r.barycenter*r.weight,e+=r.weight),n.vs=r.vs.concat(n.vs),n.barycenter=t/e,n.weight=e,n.i=Math.min(r.i,n.i),r.merged=!0}function Bt(n,r){var t=ot(n,function(s){return Object.prototype.hasOwnProperty.call(s,"barycenter")}),e=t.lhs,o=M(t.rhs,function(s){return-s.i}),a=[],i=0,u=0,c=0;e.sort(qt(!!r)),c=sn(a,o,c),f(e,function(s){c+=s.vs.length,a.push(s.vs),i+=s.barycenter*s.weight,u+=s.weight,c=sn(a,o,c)});var d={vs:O(a)};return u&&(d.barycenter=i/u,d.weight=u),d}function sn(n,r,t){for(var e;r.length&&(e=$(r)).i<=t;)r.pop(),n.push(e.vs),t++;return t}function qt(n){return function(r,t){return r.barycenter<t.barycenter?-1:r.barycenter>t.barycenter?1:n?t.i-r.i:r.i-t.i}}function Gn(n,r,t,e){var o=n.children(r),a=n.node(r),i=a?a.borderLeft:void 0,u=a?a.borderRight:void 0,c={};i&&(o=R(o,function(l){return l!==i&&l!==u}));var d=$t(n,o);f(d,function(l){if(n.children(l.v).length){var w=Gn(n,l.v,t,e);c[l.v]=w,Object.prototype.hasOwnProperty.call(w,"barycenter")&&Vt(l,w)}});var s=St(d,t);Yt(s,c);var h=Bt(s,e);if(i&&(h.vs=O([i,h.vs,u]),n.predecessors(i).length)){var v=n.node(n.predecessors(i)[0]),g=n.node(n.predecessors(u)[0]);Object.prototype.hasOwnProperty.call(h,"barycenter")||(h.barycenter=0,h.weight=0),h.barycenter=(h.barycenter*h.weight+v.order+g.order)/(h.weight+2),h.weight+=2}return h}function Yt(n,r){f(n,function(t){t.vs=O(t.vs.map(function(e){return r[e]?r[e].vs:e}))})}function Vt(n,r){b(n.barycenter)?(n.barycenter=r.barycenter,n.weight=r.weight):(n.barycenter=(n.barycenter*n.weight+r.barycenter*r.weight)/(n.weight+r.weight),n.weight+=r.weight)}function At(n){var r=In(n),t=hn(n,E(1,r+1),"inEdges"),e=hn(n,E(r-1,-1,-1),"outEdges"),o=Ct(n);vn(n,o);for(var a=Number.POSITIVE_INFINITY,i,u=0,c=0;c<4;++u,++c){zt(u%2?t:e,u%4>=2),o=B(n);var d=Tt(n,o);d<a&&(c=0,i=yr(o),a=d)}vn(n,i)}function hn(n,r,t){return p(r,function(e){return Rt(n,e,t)})}function zt(n,r){var t=new m;f(n,function(e){var o=e.graph().root,a=Gn(e,o,t,r);f(a.vs,function(i,u){e.node(i).order=u}),jt(e,t,a.vs)})}function vn(n,r){f(r,function(t){f(t,function(e,o){n.node(e).order=o})})}function Dt(n){var r=Jt(n);f(n.graph().dummyChains,function(t){for(var e=n.node(t),o=e.edgeObj,a=Ht(n,r,o.v,o.w),i=a.path,u=a.lca,c=0,d=i[c],s=!0;t!==o.w;){if(e=n.node(t),s){for(;(d=i[c])!==u&&n.node(d).maxRank<e.rank;)c++;d===u&&(s=!1)}if(!s){for(;c<i.length-1&&n.node(d=i[c+1]).minRank<=e.rank;)c++;d=i[c]}n.setParent(t,d),t=n.successors(t)[0]}})}function Ht(n,r,t,e){var o=[],a=[],i=Math.min(r[t].low,r[e].low),u=Math.max(r[t].lim,r[e].lim),c,d;c=t;do c=n.parent(c),o.push(c);while(c&&(r[c].low>i||u>r[c].lim));for(d=c,c=e;(c=n.parent(c))!==d;)a.push(c);return{path:o.concat(a.reverse()),lca:d}}function Jt(n){var r={},t=0;function e(o){var a=t;f(n.children(o),e),r[o]={low:a,lim:t++}}return f(n.children(),e),r}function Ut(n,r){var t={};function e(o,a){var i=0,u=0,c=o.length,d=$(a);return f(a,function(s,h){var v=Qt(n,s),g=v?n.node(v).order:c;(v||s===d)&&(f(a.slice(u,h+1),function(l){f(n.predecessors(l),function(w){var _=n.node(w),rn=_.order;(rn<i||g<rn)&&!(_.dummy&&n.node(l).dummy)&&Bn(t,w,l)})}),u=h+1,i=g)}),a}return F(r,e),t}function Zt(n,r){var t={};function e(a,i,u,c,d){var s;f(E(i,u),function(h){s=a[h],n.node(s).dummy&&f(n.predecessors(s),function(v){var g=n.node(v);g.dummy&&(g.order<c||g.order>d)&&Bn(t,v,s)})})}function o(a,i){var u=-1,c,d=0;return f(i,function(s,h){if(n.node(s).dummy==="border"){var v=n.predecessors(s);v.length&&(c=n.node(v[0]).order,e(i,d,h,u,c),d=h,u=c)}e(i,d,i.length,c,a.length)}),i}return F(r,o),t}function Qt(n,r){if(n.node(r).dummy)return Z(n.predecessors(r),function(t){return n.node(t).dummy})}function Bn(n,r,t){if(r>t){var e=r;r=t,t=e}Object.prototype.hasOwnProperty.call(n,r)||Object.defineProperty(n,r,{enumerable:!0,configurable:!0,value:{},writable:!0});var o=n[r];Object.defineProperty(o,t,{enumerable:!0,configurable:!0,value:!0,writable:!0})}function Wt(n,r,t){if(r>t){var e=r;r=t,t=e}return!!n[r]&&Object.prototype.hasOwnProperty.call(n[r],t)}function Kt(n,r,t,e){var o={},a={},i={};return f(r,function(u){f(u,function(c,d){o[c]=c,a[c]=c,i[c]=d})}),f(r,function(u){var c=-1;f(u,function(d){var s=e(d);if(s.length){s=M(s,function(w){return i[w]});for(var h=(s.length-1)/2,v=Math.floor(h),g=Math.ceil(h);v<=g;++v){var l=s[v];a[d]===d&&c<i[l]&&!Wt(t,d,l)&&(a[l]=d,a[d]=o[d]=o[l],c=i[l])}}})}),{root:o,align:a}}function Xt(n,r,t,e,o){var a={},i=ne(n,r,t,o),u=o?"borderLeft":"borderRight";function c(h,v){for(var g=i.nodes(),l=g.pop(),w={};l;)w[l]?h(l):(w[l]=!0,g.push(l),g=g.concat(v(l))),l=g.pop()}function d(h){a[h]=i.inEdges(h).reduce(function(v,g){return Math.max(v,a[g.v]+i.edge(g))},0)}function s(h){var v=i.outEdges(h).reduce(function(l,w){return Math.min(l,a[w.w]-i.edge(w))},Number.POSITIVE_INFINITY),g=n.node(h);v!==Number.POSITIVE_INFINITY&&g.borderType!==u&&(a[h]=Math.max(a[h],v))}return c(d,i.predecessors.bind(i)),c(s,i.successors.bind(i)),f(e,function(h){a[h]=a[t[h]]}),a}function ne(n,r,t,e){var o=new m,a=n.graph(),i=ie(a.nodesep,a.edgesep,e);return f(r,function(u){var c;f(u,function(d){var s=t[d];if(o.setNode(s),c){var h=t[c],v=o.edge(h,s);o.setEdge(h,s,Math.max(i(n,d,c),v||0))}c=d})}),o}function re(n,r){return Q(x(r),function(t){var e=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return _r(t,function(a,i){var u=ae(n,i)/2;e=Math.max(a+u,e),o=Math.min(a-u,o)}),e-o})}function te(n,r){var t=x(r),e=I(t),o=y(t);f(["u","d"],function(a){f(["l","r"],function(i){var u=a+i,c=n[u],d;if(c!==r){var s=x(c);d=i==="l"?e-I(s):o-y(s),d&&(n[u]=G(c,function(h){return h+d}))}})})}function ee(n,r){return G(n.ul,function(t,e){if(r)return n[r.toLowerCase()][e];var o=M(p(n,e));return(o[1]+o[2])/2})}function oe(n){var r=B(n),t=J(Ut(n,r),Zt(n,r)),e={},o;f(["u","d"],function(i){o=i==="u"?r:x(r).reverse(),f(["l","r"],function(u){u==="r"&&(o=p(o,function(h){return x(h).reverse()}));var c=(i==="u"?n.predecessors:n.successors).bind(n),d=Kt(n,o,t,c),s=Xt(n,o,d.root,d.align,u==="r");u==="r"&&(s=G(s,function(h){return-h})),e[i+u]=s})});var a=re(n,e);return te(e,a),ee(e,n.graph().align)}function ie(n,r,t){return function(e,o,a){var i=e.node(o),u=e.node(a),c=0,d;if(c+=i.width/2,Object.prototype.hasOwnProperty.call(i,"labelpos"))switch(i.labelpos.toLowerCase()){case"l":d=-i.width/2;break;case"r":d=i.width/2;break}if(d&&(c+=t?d:-d),d=0,c+=(i.dummy?r:n)/2,c+=(u.dummy?r:n)/2,c+=u.width/2,Object.prototype.hasOwnProperty.call(u,"labelpos"))switch(u.labelpos.toLowerCase()){case"l":d=u.width/2;break;case"r":d=-u.width/2;break}return d&&(c+=t?d:-d),d=0,c}}function ae(n,r){return n.node(r).width}function ue(n){n=_n(n),ce(n),Ir(oe(n),function(r,t){n.node(t).x=r})}function ce(n){var r=B(n),t=n.graph().ranksep,e=0;f(r,function(o){var a=y(p(o,function(i){return n.node(i).height}));f(o,function(i){n.node(i).y=e+a/2}),e+=a+t})}function Se(n,r){var t=it;t("layout",()=>{var e=t("  buildLayoutGraph",()=>me(n));t("  runLayout",()=>de(e,t)),t("  updateInputGraph",()=>fe(n,e))})}function de(n,r){r("    makeSpaceForEdgeLabels",()=>ye(n)),r("    removeSelfEdges",()=>je(n)),r("    acyclic",()=>Kr(n)),r("    nestingGraph.run",()=>Nt(n)),r("    rank",()=>xt(_n(n))),r("    injectEdgeLabelProxies",()=>ke(n)),r("    removeEmptyRanks",()=>et(n)),r("    nestingGraph.cleanup",()=>Pt(n)),r("    normalizeRanks",()=>tt(n)),r("    assignRankMinMax",()=>xe(n)),r("    removeEdgeLabelProxies",()=>Ee(n)),r("    normalize.run",()=>st(n)),r("    parentDummyChains",()=>Dt(n)),r("    addBorderSegments",()=>at(n)),r("    order",()=>At(n)),r("    insertSelfEdges",()=>Re(n)),r("    adjustCoordinateSystem",()=>ut(n)),r("    position",()=>ue(n)),r("    positionSelfEdges",()=>Me(n)),r("    removeBorderNodes",()=>Pe(n)),r("    normalize.undo",()=>vt(n)),r("    fixupEdgeLabelCoords",()=>_e(n)),r("    undoCoordinateSystem",()=>ct(n)),r("    translateGraph",()=>Oe(n)),r("    assignNodeIntersects",()=>Ne(n)),r("    reversePoints",()=>Ie(n)),r("    acyclic.undo",()=>nt(n))}function fe(n,r){f(n.nodes(),function(t){var e=n.node(t),o=r.node(t);e&&(e.x=o.x,e.y=o.y,r.children(t).length&&(e.width=o.width,e.height=o.height))}),f(n.edges(),function(t){var e=n.edge(t),o=r.edge(t);e.points=o.points,Object.prototype.hasOwnProperty.call(o,"x")&&(e.x=o.x,e.y=o.y)}),n.graph().width=r.graph().width,n.graph().height=r.graph().height}var se=["nodesep","edgesep","ranksep","marginx","marginy"],he={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},ve=["acyclicer","ranker","rankdir","align"],ge=["width","height"],le={width:0,height:0},pe=["minlen","weight","width","height","labeloffset"],we={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},be=["labelpos"];function me(n){var r=new m({multigraph:!0,compound:!0}),t=D(n.graph());return r.setGraph(J({},he,z(t,se),S(t,ve))),f(n.nodes(),function(e){var o=D(n.node(e));r.setNode(e,xr(z(o,ge),le)),r.setParent(e,n.parent(e))}),f(n.edges(),function(e){var o=D(n.edge(e));r.setEdge(e,J({},we,z(o,pe),S(o,be)))}),r}function ye(n){var r=n.graph();r.ranksep/=2,f(n.edges(),function(t){var e=n.edge(t);e.minlen*=2,e.labelpos.toLowerCase()!=="c"&&(r.rankdir==="TB"||r.rankdir==="BT"?e.width+=e.labeloffset:e.height+=e.labeloffset)})}function ke(n){f(n.edges(),function(r){var t=n.edge(r);if(t.width&&t.height){var e=n.node(r.v),o=n.node(r.w),a={rank:(o.rank-e.rank)/2+e.rank,e:r};N(n,"edge-proxy",a,"_ep")}})}function xe(n){var r=0;f(n.nodes(),function(t){var e=n.node(t);e.borderTop&&(e.minRank=n.node(e.borderTop).rank,e.maxRank=n.node(e.borderBottom).rank,r=y(r,e.maxRank))}),n.graph().maxRank=r}function Ee(n){f(n.nodes(),function(r){var t=n.node(r);t.dummy==="edge-proxy"&&(n.edge(t.e).labelRank=t.rank,n.removeNode(r))})}function Oe(n){var r=Number.POSITIVE_INFINITY,t=0,e=Number.POSITIVE_INFINITY,o=0,a=n.graph(),i=a.marginx||0,u=a.marginy||0;function c(d){var s=d.x,h=d.y,v=d.width,g=d.height;r=Math.min(r,s-v/2),t=Math.max(t,s+v/2),e=Math.min(e,h-g/2),o=Math.max(o,h+g/2)}f(n.nodes(),function(d){c(n.node(d))}),f(n.edges(),function(d){var s=n.edge(d);Object.prototype.hasOwnProperty.call(s,"x")&&c(s)}),r-=i,e-=u,f(n.nodes(),function(d){var s=n.node(d);s.x-=r,s.y-=e}),f(n.edges(),function(d){var s=n.edge(d);f(s.points,function(h){h.x-=r,h.y-=e}),Object.prototype.hasOwnProperty.call(s,"x")&&(s.x-=r),Object.prototype.hasOwnProperty.call(s,"y")&&(s.y-=e)}),a.width=t-r+i,a.height=o-e+u}function Ne(n){f(n.edges(),function(r){var t=n.edge(r),e=n.node(r.v),o=n.node(r.w),a,i;t.points?(a=t.points[0],i=t.points[t.points.length-1]):(t.points=[],a=o,i=e),t.points.unshift(on(e,a)),t.points.push(on(o,i))})}function _e(n){f(n.edges(),function(r){var t=n.edge(r);if(Object.prototype.hasOwnProperty.call(t,"x"))switch((t.labelpos==="l"||t.labelpos==="r")&&(t.width-=t.labeloffset),t.labelpos){case"l":t.x-=t.width/2+t.labeloffset;break;case"r":t.x+=t.width/2+t.labeloffset;break}})}function Ie(n){f(n.edges(),function(r){var t=n.edge(r);t.reversed&&t.points.reverse()})}function Pe(n){f(n.nodes(),function(r){if(n.children(r).length){var t=n.node(r),e=n.node(t.borderTop),o=n.node(t.borderBottom),a=n.node($(t.borderLeft)),i=n.node($(t.borderRight));t.width=Math.abs(i.x-a.x),t.height=Math.abs(o.y-e.y),t.x=a.x+t.width/2,t.y=e.y+t.height/2}}),f(n.nodes(),function(r){n.node(r).dummy==="border"&&n.removeNode(r)})}function je(n){f(n.edges(),function(r){if(r.v===r.w){var t=n.node(r.v);t.selfEdges||(t.selfEdges=[]),t.selfEdges.push({e:r,label:n.edge(r)}),n.removeEdge(r)}})}function Re(n){var r=B(n);f(r,function(t){var e=0;f(t,function(o,a){var i=n.node(o);i.order=a+e,f(i.selfEdges,function(u){N(n,"selfedge",{width:u.label.width,height:u.label.height,rank:i.rank,order:a+ ++e,e:u.e,label:u.label},"_se")}),delete i.selfEdges})})}function Me(n){f(n.nodes(),function(r){var t=n.node(r);if(t.dummy==="selfedge"){var e=n.node(t.e.v),o=e.x+e.width/2,a=e.y,i=t.x-o,u=e.height/2;n.setEdge(t.e,t.label),n.removeNode(r),t.label.points=[{x:o+2*i/3,y:a-u},{x:o+5*i/6,y:a-u},{x:o+i,y:a},{x:o+5*i/6,y:a+u},{x:o+2*i/3,y:a+u}],t.label.x=t.x,t.label.y=t.y}})}function z(n,r){return G(S(n,r),Number)}function D(n){var r={};return f(n,function(t,e){r[e.toLowerCase()]=t}),r}export{Se as B};
